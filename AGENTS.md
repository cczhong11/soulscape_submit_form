# Agent Notes

Minimal Cloudflare Worker that receives a form submission and writes into Lark Bitable.

## Runtime flow
- `POST /submit` only; other paths return 404.
- Parses JSON, form-urlencoded, or multipart into a flat fields map.
- Creates an Applications record, then a Visionary or Mentor record based on track detection.
- Visionary submissions optionally upload a headshot to Lark Drive.

## Key files
- `src/index.ts`: request handler and write pipeline.
- `src/records.ts`: mapping form fields to Bitable fields.
- `src/lark.ts`: Lark auth, record creation, and file upload.
- `web/index.html`: static intake UI with hardcoded endpoint.
- `scripts/get_bitable_fields.py`: refreshes `schema.md`.

## Environment
- Local dev uses `.dev.vars` for Wrangler.
- Non-sensitive vars live in `wrangler.toml` under `[vars]`.
- Sensitive values should be stored with `wrangler secret put`.

## Deploy
- Deploy with `npx wrangler deploy --env-file .dev.vars`.
- If you add an `[env.<name>]` section, use `--env <name>` instead.

## Notes
- `schema.md` is generated by `scripts/get_bitable_fields.py`.
- `web/index.html` currently posts to a fixed `endpoint` URL; update when the Worker URL changes.
